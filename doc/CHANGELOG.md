# 更新日志

本文档记录了本项目的所有重要变更。

格式遵循 [Keep a Changelog](https://keepachangelog.com/zh-CN/1.0.0/)，
版本号遵循 [语义化版本](https://semver.org/lang/zh-CN/)。

## [未发布]

### 计划中
- 图数据库优化：使用图结构加速大规模搜索
- 自定义规则功能：允许用户自定义火柴转换规则

## [v0.3] - 2026-02-16

### 新增
- **性能优化**：
  - 实现了 `isQuickValid()` 剪枝算法，提前过滤无效候选解
  - 增加 `maxMutations` 参数，限制搜索空间大小（影响解的完整性和整体速度）
  - 异步求解：`solve()` 方法改为非阻塞，避免浏览器冻结
  - 性能提升 24 倍：测试套件耗时从 132s 减少到 5.4s
- **高级语法支持**：
  - 支持等号后的正负号：`=+`、`=-`（如 `19-3-9=+7`）
  - 支持表达式开头的正负号：`+`、`-`（如 `+2+3=5`）
  - 过滤前导零：拒绝 `09`、`08` 等无效数字
- **调试功能**：
  - 添加 `?debug=1` URL 参数启用调试模式
  - 控制台显示求解耗时、解的数量、总变换数等统计信息
  - 前端 `performance.now()` 精确计时

### 变更
- 优化 `app.js` 中的 `maxMutations` 动态设置：长表达式使用更大的搜索空间
- 测试输出格式优化：更清晰的分组和执行时间显示

### 修复
- 修复 `handwritten.js` 中 debug 日志显示错误字符的问题

### 文档
- 修复 `doc/stantard-rules.md` 中的规则表纰漏
- 同步 `test.js` 与浏览器代码逻辑，确保测试环境一致性

## [v0.2] - 2026-02-11

### 新增
- 支持移动两根火柴（标准模式与手写模式）。
- 增加 UI 移动数量选择器（1 根 / 2 根）与规则查看器改进。
- 背景音乐开关，并保存用户偏好。

### 变更
- 优化 UI 求解防抖，提升性能。

### 修复
- 在两根火柴模式中过滤单步重复解，拒绝无效的规范化解（如连续等号等）。
- 修复向 Set 中添加规则时未初始化导致的错误。
- 过滤自身解：解集不再包含与原始输入相同的等式。
- 增强2根火柴求解器，添加 `transformAndMove` 组合。
- 修复 test.js 中缺失的 `filterOutSingleMoveSolutions` 过滤逻辑，确保测试与前端UI行为一致。
- 对连续的 '1' 序列（如 `111`）进行了特殊处理：在 `mutate`/tokenize 过程中尝试不同的分组方式（例如 `['11','1']` 与 `['1','11']`），从而支持像 `111+1=0` → `10+1=11` 这样的解。

### 测试
- 扩展测试用例至30个，包含标准/手写模式的1根和2根火柴移动测试。

### 文档
- 更新 README，添加截图占位。

## [v0.1] - 2026-02-10

### 新增
- 初始功能：标准模式与手写模式，SVG 渲染，双语界面。
